head
  style
    include ../stylesheets/basic.css
    include ../stylesheets/create-task.css
    include ../stylesheets/dashboard.css
    include ../stylesheets/task.css
  include ./partials/topbar.pug
  include ./partials/message.pug
  script(src='./socket.io/socket.io.js')
  script
    include ../scripts/jquery.js
  script
    include ../scripts/taskHandler.js
    include ../scripts/createTask.js
  script.
    var socket = io();
    let id = "#{id}";
    socket.emit('declareId', {userId : "#{id}"});
    socket.on('message', function(message){
      console.log(message);
      // Stub
    })
    socket.on('task-edit', function(task){
      getTaskEl(task._id).replaceWith(renderTask(task));
      tasks.splice(tasks.indexOf(tasks.find((el) => el._id == task._id)), 1, task);
    })
    socket.on('new-subtask', function(subtask) {
      tasks.push(subtask);
    });

    var tasks = !{JSON.stringify(tasks)};
    var filtered_tasks = [];
    var known_associates = !{JSON.stringify(known_associates)};
    var subs = !{JSON.stringify(subs)};
    var tags = [];
    function updateFilteredTasks(ft){
      filtered_tasks = ft;
    }

    $('document').ready(function(){
      console.log(tasks);
      $('#rtf-container').append(renderTaskFilter(tasks, tags, filtered_tasks));
      //- $('#task-view').append(renderTasks(tasks, tags));
      //- filterTasks();
      updateKnownAssociates();
    })

body    

  +topbar(name)
  +message(messages)
  #rtf-container
  .separation-bar
  #task-view
  









  

